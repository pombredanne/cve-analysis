{
  "settings":{
     "number_of_shards" : 5,
     "index":{
        "analysis":{
           "analyzer":{
              "analyzer_shingle":{
                 "tokenizer":"standard",
                 "filter":["lowercase", "filter_stop", "filter_shingle"]
              }
           },
           "filter":{
              "filter_shingle":{
                 "type":"shingle",
                 "max_shingle_size":3,
                 "min_shingle_size":2,
                 "output_unigrams":"true"
              },
              "filter_stop":{
                 "type":"stop"
              }
           }
        }
     }
  },
    "mappings" : {
      "properties" : {
        "CVE_data_meta" : {
          "properties" : {
            "ASSIGNER" : {
              "type" : "text",
              "fields" : {
                "keyword" : {
                  "type" : "keyword",
                  "ignore_above" : 256
                }
              }
            },
            "ID" : {
              "type" : "text",
              "fields" : {
                "keyword" : {
                  "type" : "keyword",
                  "ignore_above" : 256
                }
              }
            }
          }
        },
        "affects" : {
          "properties" : {
            "vendor" : {
              "properties" : {
                "vendor_data" : {
                  "properties" : {
                    "product" : {
                      "properties" : {
                        "product_data" : {
                          "properties" : {
                            "product_name" : {
                              "type" : "text",
                              "fields" : {
                                "keyword" : {
                                  "type" : "keyword",
                                  "ignore_above" : 256
                                }
                              }
                            },
                            "version" : {
                              "properties" : {
                                "version_data" : {
                                  "properties" : {
                                    "version_affected" : {
                                      "type" : "text",
                                      "fields" : {
                                        "keyword" : {
                                          "type" : "keyword",
                                          "ignore_above" : 256
                                        }
                                      }
                                    },
                                    "version_value" : {
                                      "type" : "text",
                                      "fields" : {
                                        "keyword" : {
                                          "type" : "keyword",
                                          "ignore_above" : 256
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "vendor_name" : {
                      "type" : "text",
                      "fields" : {
                        "keyword" : {
                          "type" : "keyword",
                          "ignore_above" : 256
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "baseMetricV2" : {
          "properties" : {
            "acInsufInfo" : {
              "type" : "boolean"
            },
            "cvssV2" : {
              "properties" : {
                "accessComplexity" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "accessVector" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "authentication" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "availabilityImpact" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "baseScore" : {
                  "type" : "float"
                },
                "confidentialityImpact" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "integrityImpact" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "vectorString" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "version" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                }
              }
            },
            "exploitabilityScore" : {
              "type" : "float"
            },
            "impactScore" : {
              "type" : "float"
            },
            "obtainAllPrivilege" : {
              "type" : "boolean"
            },
            "obtainOtherPrivilege" : {
              "type" : "boolean"
            },
            "obtainUserPrivilege" : {
              "type" : "boolean"
            },
            "severity" : {
              "type" : "text",
              "fields" : {
                "keyword" : {
                  "type" : "keyword",
                  "ignore_above" : 256
                }
              }
            },
            "userInteractionRequired" : {
              "type" : "boolean"
            }
          }
        },
        "baseMetricV3" : {
          "properties" : {
            "cvssV3" : {
              "properties" : {
                "attackComplexity" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "attackVector" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "availabilityImpact" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "baseScore" : {
                  "type" : "float"
                },
                "baseSeverity" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "confidentialityImpact" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "integrityImpact" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "privilegesRequired" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "scope" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "userInteraction" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "vectorString" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "version" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                }
              }
            },
            "exploitabilityScore" : {
              "type" : "float"
            },
            "impactScore" : {
              "type" : "float"
            }
          }
        },
        "data_format" : {
          "type" : "text",
          "fields" : {
            "keyword" : {
              "type" : "keyword",
              "ignore_above" : 256
            }
          }
        },
        "data_type" : {
          "type" : "text",
          "fields" : {
            "keyword" : {
              "type" : "keyword",
              "ignore_above" : 256
            }
          }
        },
        "data_version" : {
          "type" : "text",
          "fields" : {
            "keyword" : {
              "type" : "keyword",
              "ignore_above" : 256
            }
          }
        },
        "description" : {
          "properties" : {
            "description_data" : {
              "properties" : {
                "lang" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "value" : {
                  "type" : "text",
                  "fielddata" : "true",
                  "analyzer" : "english",
                  "fields" : {
                    "keyword" : { "type" : "keyword" },
                    "shingle" : { "type" : "text",
                                  "fielddata" : "true",
                                  "analyzer" : "analyzer_shingle"
                                }
                  }
                }
              }
            }
          }
        },
        "problemtype" : {
          "properties" : {
            "problemtype_data" : {
              "properties" : {
                "description" : {
                  "properties" : {
                    "lang" : {
                      "type" : "text",
                      "fields" : {
                        "keyword" : {
                          "type" : "keyword",
                          "ignore_above" : 256
                        }
                      }
                    },
                    "value" : {
                      "type" : "text",
                      "fields" : {
                        "keyword" : {
                          "type" : "keyword",
                          "ignore_above" : 256
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "references" : {
          "properties" : {
            "reference_data" : {
              "properties" : {
                "name" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "refsource" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "tags" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                },
                "url" : {
                  "type" : "text",
                  "fields" : {
                    "keyword" : {
                      "type" : "keyword",
                      "ignore_above" : 256
                    }
                  }
                }
              }
            }
          }
        },
        "year" : {
          "type" : "integer"
        },
        "rh_cvssv3" : {
          "type" : "float"
        },
        "rh_cvssv2" : {
          "type" : "float"
        },
        "rh_impact" : {
          "type" : "text",
          "fields" : {
            "keyword" : {
              "type" : "keyword",
              "ignore_above" : 256
            }
          }
        },
        "just_id" : {
          "type" : "integer"
        }
      }
    }
  }

